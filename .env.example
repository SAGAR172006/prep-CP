# ================================================================================================
# PREP CP - COMPLETE ENVIRONMENT CONFIGURATION
# ================================================================================================
# 
# This is a comprehensive .env file for the Prep CP coding platform.
# All services listed here have FREE TIER options that can support 1000+ users.
# See ENV_SETUP_GUIDE.md for detailed instructions on obtaining each credential.
#
# ================================================================================================

# ================================================================================================
# 1. APPLICATION SETTINGS
# ================================================================================================

# Node Environment (development, production, test)
NODE_ENV=development

# Application URL (update this for production deployment)
# Local: http://localhost:3000
# Production: https://yourdomain.com
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ================================================================================================
# 2. DATABASE & BACKEND (Supabase)
# ================================================================================================
# Supabase provides PostgreSQL database, Authentication, Storage, and Realtime features
# Free Tier: 500MB database, 2GB bandwidth/month, unlimited API requests
# Setup Guide: See ENV_SETUP_GUIDE.md Section 2

NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_public_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_secret_key

# Optional: Direct PostgreSQL connection string (for Prisma or advanced use)
# Format: postgresql://postgres:[PASSWORD]@db.[PROJECT_REF].supabase.co:5432/postgres
DATABASE_URL=postgresql://postgres:your_password@db.your_project_ref.supabase.co:5432/postgres

# ================================================================================================
# 3. AUTHENTICATION (NextAuth.js)
# ================================================================================================
# NextAuth handles all authentication providers
# Setup Guide: See ENV_SETUP_GUIDE.md Section 3

# NextAuth URL - Update for production
NEXTAUTH_URL=http://localhost:3000

# NextAuth Secret - Generate using: openssl rand -base64 32
# IMPORTANT: Keep this secret and unique per environment!
NEXTAUTH_SECRET=generate_random_secret_using_openssl_rand_base64_32

# ================================================================================================
# 4. OAUTH PROVIDERS
# ================================================================================================

# ---------- Google OAuth ----------
# Free service for authentication
# Setup Guide: See ENV_SETUP_GUIDE.md Section 4.1
GOOGLE_CLIENT_ID=your_google_oauth_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_oauth_client_secret

# ---------- GitHub OAuth ----------
# Free service for authentication
# Setup Guide: See ENV_SETUP_GUIDE.md Section 4.2
GITHUB_CLIENT_ID=your_github_oauth_client_id
GITHUB_CLIENT_SECRET=your_github_oauth_client_secret

# ================================================================================================
# 5. AI & LLM SERVICES
# ================================================================================================

# ---------- Ollama (Self-Hosted LLM - Recommended) ----------
# Completely free, unlimited usage, runs locally
# Setup Guide: See ENV_SETUP_GUIDE.md Section 5.1
OLLAMA_HOST=http://localhost:11434
# Default models to use (comma-separated): llama3, codellama, mistral
OLLAMA_DEFAULT_MODEL=llama3

# ---------- Hugging Face (Cloud AI/LLM) ----------
# Free Tier: 30,000 requests/month
# Setup Guide: See ENV_SETUP_GUIDE.md Section 5.2
HUGGINGFACE_API_KEY=hf_your_huggingface_api_key

# ---------- Google Gemini (AI Fallback) ----------
# Free Tier: 60 requests/minute, generous daily quota
# Setup Guide: See ENV_SETUP_GUIDE.md Section 5.3
GOOGLE_GEMINI_API_KEY=your_google_gemini_api_key

# AI Service Priority (comma-separated): ollama, huggingface, gemini
# The system will try services in this order
AI_SERVICE_PRIORITY=ollama,gemini,huggingface

# ================================================================================================
# 6. CODE EXECUTION (Piston API)
# ================================================================================================
# Piston API provides secure code execution in 50+ programming languages
# Free Tier: Public API available, or self-host for unlimited use
# Setup Guide: See ENV_SETUP_GUIDE.md Section 6

# Option 1: Public Piston API (Free, rate-limited)
PISTON_API_URL=https://emkc.org/api/v2/piston

# Option 2: Self-Hosted Piston (Recommended for production)
# PISTON_API_URL=http://localhost:2000

# ================================================================================================
# 7. CACHING (Upstash Redis)
# ================================================================================================
# Redis for rate limiting, session management, and caching
# Free Tier: 10,000 commands/day, 256MB storage
# Setup Guide: See ENV_SETUP_GUIDE.md Section 7

UPSTASH_REDIS_REST_URL=https://your-redis-instance.upstash.io
UPSTASH_REDIS_REST_TOKEN=your_upstash_redis_rest_token

# Optional: Classic Redis connection (if self-hosting)
# REDIS_URL=redis://localhost:6379

# ================================================================================================
# 8. FILE STORAGE & MEDIA (Cloudinary)
# ================================================================================================
# Cloudinary for user avatars, banners, problem images, and file uploads
# Free Tier: 25GB storage, 25GB bandwidth/month, 25k transformations
# Setup Guide: See ENV_SETUP_GUIDE.md Section 8

NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloudinary_cloud_name
CLOUDINARY_API_KEY=your_cloudinary_api_key
CLOUDINARY_API_SECRET=your_cloudinary_api_secret

# Optional: Upload preset for unsigned uploads (create in Cloudinary dashboard)
NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET=your_upload_preset_name

# ================================================================================================
# 9. EMAIL SERVICE (Resend)
# ================================================================================================
# Resend for transactional emails (welcome, password reset, notifications)
# Free Tier: 3,000 emails/month, 100 emails/day
# Setup Guide: See ENV_SETUP_GUIDE.md Section 9

RESEND_API_KEY=re_your_resend_api_key
# Email address for sending (must be verified domain or use test domain)
RESEND_FROM_EMAIL=noreply@yourdomain.com
# For testing, use: onboarding@resend.dev

# Optional: Support/Contact email
SUPPORT_EMAIL=support@yourdomain.com

# ================================================================================================
# 10. PAYMENT PROCESSING (Razorpay)
# ================================================================================================
# Razorpay for Pro subscription payments (primarily for Indian users)
# Free to integrate, only pay transaction fees when you earn revenue
# Setup Guide: See ENV_SETUP_GUIDE.md Section 10

# Razorpay Account Keys (get from dashboard)
RAZORPAY_KEY_ID=rzp_test_your_key_id
RAZORPAY_KEY_SECRET=your_razorpay_key_secret
NEXT_PUBLIC_RAZORPAY_KEY_ID=rzp_test_your_key_id

# Webhook Secret (for payment verification)
RAZORPAY_WEBHOOK_SECRET=your_razorpay_webhook_secret

# Note: Use test keys (rzp_test_*) for development, live keys (rzp_live_*) for production

# ================================================================================================
# 11. MONITORING & ANALYTICS
# ================================================================================================

# ---------- Sentry (Error Monitoring) ----------
# Free Tier: 5,000 errors/month
# Setup Guide: See ENV_SETUP_GUIDE.md Section 11.1
NEXT_PUBLIC_SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_AUTH_TOKEN=your_sentry_auth_token
SENTRY_ORG=your_organization_slug
SENTRY_PROJECT=your_project_slug

# Environment for Sentry (production, staging, development)
SENTRY_ENVIRONMENT=development

# ---------- PostHog (Analytics & Feature Flags) ----------
# Free Tier: 1M events/month, unlimited feature flags
# Setup Guide: See ENV_SETUP_GUIDE.md Section 11.2
NEXT_PUBLIC_POSTHOG_KEY=phc_your_posthog_project_api_key
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com
# For self-hosted PostHog: https://your-posthog-instance.com

# ================================================================================================
# 12. RATE LIMITING & SECURITY
# ================================================================================================

# Rate limit for API requests (requests per minute)
RATE_LIMIT_MAX_REQUESTS=60
RATE_LIMIT_WINDOW_MS=60000

# Rate limit for AI bot queries (per day)
AI_BOT_FREE_QUERIES_PER_DAY=20
AI_BOT_PRO_QUERIES_PER_DAY=100

# Anti-cheat: Minimum time multiplier for problem solving (seconds per difficulty level)
MIN_SOLVE_TIME_EASY=30
MIN_SOLVE_TIME_MEDIUM=60
MIN_SOLVE_TIME_HARD=120

# JWT Token expiry (in seconds)
JWT_EXPIRES_IN=86400

# Session expiry (in days)
SESSION_MAX_AGE=30

# ================================================================================================
# 13. FEATURE FLAGS
# ================================================================================================

# Enable/disable features
FEATURE_COMPETITIVE_MODE=true
FEATURE_AI_CHATBOT=true
FEATURE_DAILY_PUZZLE=true
FEATURE_SOCIAL_FEATURES=true
FEATURE_PRO_SUBSCRIPTION=true
FEATURE_BUG_REPORTING=true

# Maintenance mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We're performing scheduled maintenance. Be back soon!

# ================================================================================================
# 14. PRO SUBSCRIPTION SETTINGS
# ================================================================================================

# Pro subscription pricing (in smallest currency unit, e.g., paise for INR)
PRO_MONTHLY_PRICE=9900
PRO_YEARLY_PRICE=99900
PRO_CURRENCY=INR

# Pro features configuration
PRO_AI_QUERIES_DAILY=100
PRO_DAILY_PUZZLES_UNLOCK=true
PRO_EXCLUSIVE_PROBLEMS=true

# ================================================================================================
# 15. GAMIFICATION SETTINGS
# ================================================================================================

# Points system
BASE_POINTS_PER_PROBLEM=10
POINTS_PENALTY_PER_ATTEMPT=1
MIN_POINTS_PER_PROBLEM=5
POINTS_PENALTY_ABORT=3
POINTS_REWARD_BUG_FIX=5
POINTS_PENALTY_FAST_SOLVE=2

# League thresholds
LEAGUE_BRONZE_MAX=200
LEAGUE_SILVER_MAX=400
LEAGUE_GOLD_MAX=600
LEAGUE_DIAMOND_MAX=800
LEAGUE_MASTER_MAX=1000

# Season settings
SEASON_DURATION_MONTHS=3

# ================================================================================================
# 16. SOCIAL FEATURES
# ================================================================================================

# Friend limits
MAX_FRIENDS_FREE=50
MAX_FRIENDS_PRO=500

# Challenge settings
CHALLENGE_MATCHMAKING_TIMEOUT_SECONDS=50
CHALLENGE_AI_BOT_SLOWNESS_PERCENT=10

# ================================================================================================
# 17. CDN & HOSTING (Optional - Vercel/Cloudflare)
# ================================================================================================

# Cloudflare (for CDN, DDoS protection, DNS)
# Free Tier: Unlimited bandwidth, DDoS protection
# Setup: Add your domain to Cloudflare after deployment
# CLOUDFLARE_ZONE_ID=your_cloudflare_zone_id
# CLOUDFLARE_API_TOKEN=your_cloudflare_api_token

# Vercel (Deployment)
# Free Tier: Unlimited personal projects, 100GB bandwidth
# Setup: Connect GitHub repo to Vercel for auto-deployment
# VERCEL_TOKEN=your_vercel_api_token

# ================================================================================================
# 18. DEVELOPMENT & DEBUGGING
# ================================================================================================

# Enable debug logging
DEBUG=false
VERBOSE_LOGGING=false

# Database logging
DATABASE_LOGGING=false

# Disable telemetry
NEXT_TELEMETRY_DISABLED=1

# ================================================================================================
# 19. EXTERNAL INTEGRATIONS (Optional)
# ================================================================================================

# Slack notifications for critical events (optional)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Discord notifications for community (optional)
# DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK

# Google Analytics (optional)
# NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ================================================================================================
# 20. TESTING & CI/CD
# ================================================================================================

# Test database (use separate Supabase project for testing)
# TEST_DATABASE_URL=postgresql://postgres:password@localhost:5432/test_db
# TEST_SUPABASE_URL=your_test_supabase_url
# TEST_SUPABASE_ANON_KEY=your_test_anon_key

# E2E Testing
# PLAYWRIGHT_TEST_BASE_URL=http://localhost:3000

# ================================================================================================
# NOTES
# ================================================================================================
# 1. Never commit this file with real credentials to version control
# 2. Use .env.local for local development (automatically ignored by Git)
# 3. Store production secrets securely (Vercel Environment Variables, AWS Secrets Manager, etc.)
# 4. Generate strong secrets for NEXTAUTH_SECRET and other sensitive values
# 5. Use test/development keys during development, switch to production keys when deploying
# 6. Refer to ENV_SETUP_GUIDE.md for detailed setup instructions for each service
# ================================================================================================
